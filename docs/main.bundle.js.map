{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/canvas/HistoryCanvas.ts","webpack:///./src/renderers/Renderer.ts","webpack:///./src/models/Orderable.ts","webpack:///./src/canvas/Properties.js","webpack:///./src/models/Person.ts","webpack:///./src/models/Event.ts","webpack:///./src/index.ts","webpack:///./src/canvas/InteractiveCanvas.ts","webpack:///./node_modules/moment/locale sync a^","webpack:///./src/renderers/FacetRenderer.ts","webpack:///./src/renderers/PersonRenderer.ts","webpack:///./src/renderers/EventRenderer.ts","webpack:///./src/renderers/EraRenderer.ts","webpack:///./src/renderers/Lanes.ts","webpack:///./src/Parser.ts","webpack:///./src/models/Era.ts","webpack:///./src/models/Facet.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","1","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","extendStatics","__extends","this","b","setPrototypeOf","__proto__","Array","__","constructor","__importDefault","mod","HistoryCanvas","fabric_1","Properties_1","moment_1","FacetRenderer_1","_super","_this","fabric","selectable","Textbox","editable","fontFamily","initializeCanvas","setDimensions","width","innerWidth","height","innerHeight","hoverCursor","selection","absolutePan","Point","calculateAbsoluteX","default","renderOnAddRemove","ticks","getItem","id","len","size","getObjects","render","facets","renderGrid","renderData","sort","one","two","orderByStart","requestRenderAll","remove","currentTick","FIRST_TICK","clone","isBefore","LAST_TICK","add","periodBetweenTicks","x","line","Line","viewportTransform","stroke","GRID_COLOR","hex","strokeWidth","label","format","left","top","LANE_HEIGHT","originX","originY","fontSize","textAlign","fill","textBackgroundColor","BACKGROUND_COLOR","gridline","Group","insertAt","duration","getZoom","tickCount","reduce","offset","facet","FacetRenderer","renderAll","date","calculateRelativeX","DATE_ORIGIN","start","end","diff","DATE_SCALE_UNIT","DATE_SCALE_FACTOR","Canvas","Renderer","canvas","LANE_PADDING","Orderable","other","isAfter","orderByEnd","right","HOVER_COLOR","Person","birth","death","url","events","short_name","shortName","Event","InteractiveCanvas_1","Parser_1","data_json_1","Parser","parseData","InteractiveCanvas","chroma_js_1","HistoryCanvas_1","supportResizing","addWheel","addHover","addTooltips","addWikipediaLinks","addKeyboardControl","that","onresize","on","event","wheelEvent","e","ctrlKey","_relativeZoom","deltaY","offsetX","offsetY","_pan","preventDefault","stopPropagation","amountHorizontal","amountVertical","newX","clamp","newY","delta","point","_absoluteZoom","_calculateAbsoluteZoom","zoom","absoluteZoom","zoomToPoint","original_viewportTransform","Math","ceil","floor","getHeight","options","getPointer","mouseLine","moveTo","target","tooltipText","y","tooltipBackground","Rect","brighten","setOptions","tooltip","open","document","onkeydown","min","max","webpackEmptyContext","req","Error","code","keys","resolve","Renderer_1","Person_1","Event_1","PersonRenderer_1","EventRenderer_1","EraRenderer_1","Lanes_1","eras","lanes","Lanes","objects","people","concat","addObjects","basecolor","forEach","era","EraRenderer","getLanes","lane","PersonRenderer","EventRenderer","__spreadArrays","il","arguments","k","a","jl","person","color","rect","renderedEvents","map","it","renderNestedEvent","textColor","luminance","personGlyph","buildPersonTooltip","Circle","darken","radius","join","circle","min_era_width_for_horizontal","alpha","isWideEnough","angle","eraGlyph","addLane","laneEnd","index","findLaneEndingBefore","addObject","laneIndex","Era_1","Facet_1","DATE_PARSER_FORMAT","facetName","Facet","parseEra","parsePerson","parseEvent","setColors","colorScale","scale","domain","_a","_b","Era","parseDate","_c","string","flat"],"mappings":"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","file":"main.bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t1: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([9,0,2]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HistoryCanvas = void 0;\nvar fabric_1 = require(\"fabric\");\nvar Properties_1 = require(\"./Properties\");\nvar moment_1 = __importDefault(require(\"moment\"));\nvar FacetRenderer_1 = require(\"../renderers/FacetRenderer\");\nvar HistoryCanvas = /** @class */ (function (_super) {\n    __extends(HistoryCanvas, _super);\n    function HistoryCanvas() {\n        var _this = _super.call(this, 'canvas') || this;\n        fabric_1.fabric.Object.prototype.selectable = false;\n        fabric_1.fabric.Textbox.prototype.editable = false;\n        fabric_1.fabric.Textbox.prototype.fontFamily = 'sans';\n        _this.initializeCanvas();\n        return _this;\n    }\n    HistoryCanvas.prototype.initializeCanvas = function () {\n        this.setDimensions({ width: window.innerWidth, height: window.innerHeight });\n        this.hoverCursor = 'default';\n        this.selection = false;\n        this.absolutePan(new fabric_1.fabric.Point(HistoryCanvas.calculateAbsoluteX(moment_1.default('1500-01-01', 'Y-MM-DD')), 0));\n        this.renderOnAddRemove = false;\n        this.ticks = [];\n    };\n    HistoryCanvas.prototype.getItem = function (id) {\n        for (var i = 0, len = _super.prototype.size.call(this); i < len; i++) {\n            if (this.getObjects()[i].id && this.getObjects()[i].id === id) {\n                return this.getObjects()[i];\n            }\n        }\n    };\n    HistoryCanvas.prototype.render = function (facets) {\n        this.renderGrid();\n        this.renderData(facets.sort(function (one, two) { return one.orderByStart(two); }));\n        this.requestRenderAll();\n    };\n    HistoryCanvas.prototype.renderGrid = function () {\n        this.remove.apply(this, this.ticks);\n        this.ticks.length = 0;\n        for (var currentTick = Properties_1.FIRST_TICK.clone(); currentTick.isBefore(Properties_1.LAST_TICK); currentTick.add(this.periodBetweenTicks())) {\n            var x = HistoryCanvas.calculateAbsoluteX(currentTick);\n            var line = new fabric_1.fabric.Line([\n                x,\n                -this.viewportTransform[5] / this.viewportTransform[3],\n                x,\n                (-this.viewportTransform[5] + window.innerHeight) / this.viewportTransform[3]\n            ], {\n                stroke: Properties_1.GRID_COLOR.hex(),\n                strokeWidth: 1\n            });\n            var label = new fabric_1.fabric.Textbox(currentTick.format('YYYY'), {\n                left: x,\n                top: (-this.viewportTransform[5] + window.innerHeight - Properties_1.LANE_HEIGHT) / this.viewportTransform[3],\n                originX: 'center',\n                originY: 'center',\n                fontSize: (Properties_1.LANE_HEIGHT - 4) / this.viewportTransform[3],\n                textAlign: 'center',\n                strokeWidth: 0,\n                fill: Properties_1.GRID_COLOR.hex(),\n                textBackgroundColor: Properties_1.BACKGROUND_COLOR.hex()\n            });\n            var gridline = new fabric_1.fabric.Group([line, label]);\n            this.insertAt(gridline, 1, false);\n            this.ticks.push(gridline);\n        }\n    };\n    HistoryCanvas.prototype.periodBetweenTicks = function () {\n        return moment_1.default.duration(25 / this.getZoom(), 'y');\n    };\n    HistoryCanvas.prototype.tickCount = function () {\n        return this.ticks.length - 1;\n    };\n    HistoryCanvas.prototype.renderData = function (facets) {\n        var _this = this;\n        facets.reduce(function (offset, facet) { return new FacetRenderer_1.FacetRenderer(_this, facet).render(offset); }, 0);\n        this.renderAll();\n    };\n    HistoryCanvas.calculateAbsoluteX = function (date) {\n        return HistoryCanvas.calculateRelativeX(Properties_1.DATE_ORIGIN.clone(), date);\n    };\n    HistoryCanvas.calculateRelativeX = function (start, end) {\n        return end.diff(start, Properties_1.DATE_SCALE_UNIT) / Properties_1.DATE_SCALE_FACTOR;\n    };\n    return HistoryCanvas;\n}(fabric_1.fabric.Canvas));\nexports.HistoryCanvas = HistoryCanvas;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Renderer = void 0;\nvar Renderer = /** @class */ (function () {\n    function Renderer(canvas) {\n        this.LANE_HEIGHT = 20;\n        this.LANE_PADDING = 8;\n        this.canvas = canvas;\n    }\n    return Renderer;\n}());\nexports.Renderer = Renderer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Orderable = void 0;\nvar Orderable = /** @class */ (function () {\n    function Orderable() {\n    }\n    Orderable.prototype.orderByStart = function (other) {\n        return this.left().isBefore(other.left()) ? -1\n            : this.left().isAfter(other.left()) ? 1\n                : 0;\n    };\n    Orderable.prototype.orderByEnd = function (other) {\n        return this.right().isAfter(other.right()) ? -1\n            : this.right().isBefore(other.right()) ? 1\n                : 0;\n    };\n    return Orderable;\n}());\nexports.Orderable = Orderable;\n","import chroma from 'chroma-js'\nimport moment from 'moment'\n\nexport const LANE_HEIGHT = 20\nexport const GRID_COLOR = chroma('lightgrey')\nexport const HOVER_COLOR = chroma('darkgrey')\nexport const BACKGROUND_COLOR = chroma('white')\nexport const DATE_SCALE_FACTOR = 3\nexport const DATE_SCALE_UNIT = 'M'\nexport const DATE_ORIGIN = moment('0000-01-01')\nexport const FIRST_TICK = moment('-7000', 'Y')\nexport const LAST_TICK = moment()\n\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Person = void 0;\nvar Orderable_1 = require(\"./Orderable\");\nvar Person = /** @class */ (function (_super) {\n    __extends(Person, _super);\n    function Person(name, birth, death, url, events, short_name) {\n        if (events === void 0) { events = []; }\n        if (short_name === void 0) { short_name = ''; }\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.birth = birth;\n        _this.death = death;\n        _this.url = url;\n        _this.events = events;\n        _this.shortName = short_name;\n        return _this;\n    }\n    Person.prototype.left = function () {\n        return this.birth.clone();\n    };\n    Person.prototype.right = function () {\n        return this.death.clone();\n    };\n    return Person;\n}(Orderable_1.Orderable));\nexports.Person = Person;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Event = void 0;\nvar Orderable_1 = require(\"./Orderable\");\nvar Event = /** @class */ (function (_super) {\n    __extends(Event, _super);\n    function Event(name, date, url) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.date = date;\n        _this.url = url;\n        return _this;\n    }\n    Event.prototype.left = function () {\n        return this.date.clone();\n    };\n    Event.prototype.right = function () {\n        return this.date.clone();\n    };\n    return Event;\n}(Orderable_1.Orderable));\nexports.Event = Event;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar InteractiveCanvas_1 = require(\"./canvas/InteractiveCanvas\");\nvar Parser_1 = require(\"./Parser\");\nvar data_json_1 = __importDefault(require(\"./data.json\"));\nvar parser = new Parser_1.Parser();\nvar facets = parser.parseData(data_json_1.default);\nvar canvas = new InteractiveCanvas_1.InteractiveCanvas();\ncanvas.render(facets);\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.InteractiveCanvas = void 0;\nvar fabric_1 = require(\"fabric\");\nvar chroma_js_1 = __importDefault(require(\"chroma-js\"));\nvar HistoryCanvas_1 = require(\"./HistoryCanvas\");\nvar Properties_1 = require(\"./Properties\");\nvar InteractiveCanvas = /** @class */ (function (_super) {\n    __extends(InteractiveCanvas, _super);\n    function InteractiveCanvas() {\n        var _this = _super.call(this) || this;\n        _this.supportResizing();\n        _this.addWheel();\n        _this.addHover();\n        _this.addTooltips();\n        _this.addWikipediaLinks();\n        _this.addKeyboardControl();\n        return _this;\n    }\n    InteractiveCanvas.prototype.supportResizing = function () {\n        var that = this;\n        window.onresize = function () {\n            that.setDimensions({ width: window.innerWidth, height: window.innerHeight });\n            that.renderGrid();\n            that.requestRenderAll();\n        };\n    };\n    InteractiveCanvas.prototype.addWheel = function () {\n        var that = this;\n        this.on('mouse:wheel', function (event) {\n            var wheelEvent = event.e;\n            if (wheelEvent.ctrlKey) {\n                that._relativeZoom(wheelEvent.deltaY / 20, new fabric_1.fabric.Point(wheelEvent.offsetX, wheelEvent.offsetY));\n            }\n            else {\n                that._pan(wheelEvent.deltaY * 5, 0);\n            }\n            event.e.preventDefault();\n            event.e.stopPropagation();\n        });\n    };\n    InteractiveCanvas.prototype._pan = function (amountHorizontal, amountVertical) {\n        var newX = InteractiveCanvas.clamp(HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(Properties_1.FIRST_TICK), amountHorizontal - this.viewportTransform[4], HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(Properties_1.LAST_TICK));\n        var newY = InteractiveCanvas.clamp(0, amountVertical - this.viewportTransform[5], 2 * window.innerHeight);\n        this.absolutePan(new fabric_1.fabric.Point(newX, newY));\n        if (newY > 0) {\n            this.renderGrid();\n        }\n        this.requestRenderAll();\n    };\n    InteractiveCanvas.prototype._relativeZoom = function (delta, point) {\n        this._absoluteZoom(this._calculateAbsoluteZoom(delta), point);\n    };\n    InteractiveCanvas.prototype._calculateAbsoluteZoom = function (delta) {\n        var zoom = this.getZoom();\n        return InteractiveCanvas.clamp(0.5, zoom + delta, 3);\n    };\n    InteractiveCanvas.prototype._absoluteZoom = function (absoluteZoom, point) {\n        this.zoomToPoint(point, absoluteZoom);\n        var original_viewportTransform = this.viewportTransform;\n        if (original_viewportTransform[5] >= 0) {\n            this.viewportTransform[5] = 0;\n        }\n        else if (Math.ceil(original_viewportTransform[5]) < Math.floor(this.getHeight() - window.innerHeight * absoluteZoom)) {\n            this.viewportTransform[5] = this.getHeight() - window.innerHeight * absoluteZoom;\n        }\n        this.renderGrid();\n        this.requestRenderAll();\n    };\n    InteractiveCanvas.prototype.addHover = function () {\n        var that = this;\n        var lineId = 'mouseline';\n        this.on('mouse:move', function (options) {\n            that.remove(that.getItem(lineId));\n            var p = that.getPointer(options.e);\n            var line = new fabric_1.fabric.Line([\n                p.x,\n                -that.viewportTransform[5] / that.viewportTransform[3],\n                p.x,\n                (-that.viewportTransform[5] + window.innerHeight) / that.viewportTransform[3]\n            ], {\n                stroke: Properties_1.HOVER_COLOR.hex(),\n                strokeWidth: 1\n            });\n            var label = new fabric_1.fabric.Textbox(Properties_1.DATE_ORIGIN.clone().add(p.x * Properties_1.DATE_SCALE_FACTOR, Properties_1.DATE_SCALE_UNIT).format('YYYY'), {\n                left: p.x,\n                top: (-that.viewportTransform[5] + window.innerHeight - Properties_1.LANE_HEIGHT) / that.viewportTransform[3],\n                originX: 'center',\n                originY: 'center',\n                fontSize: (Properties_1.LANE_HEIGHT - 4) / that.viewportTransform[3],\n                textAlign: 'center',\n                strokeWidth: 0,\n                fill: Properties_1.HOVER_COLOR.hex(),\n                textBackgroundColor: Properties_1.BACKGROUND_COLOR.hex()\n            });\n            var mouseLine = new fabric_1.fabric.Group([line, label], { id: lineId });\n            that.add(mouseLine);\n            mouseLine.moveTo(that.tickCount() + 1);\n            that.requestRenderAll();\n        });\n    };\n    InteractiveCanvas.prototype.addTooltips = function () {\n        var that = this;\n        this.on('mouse:over', function (event) {\n            if (event.target && event.target.tooltipText) {\n                var p = that.getPointer(event.e);\n                var tooltipText = new fabric_1.fabric.Textbox(event.target.tooltipText, {\n                    fontSize: Properties_1.LANE_HEIGHT - 7,\n                    textAlign: 'center',\n                    strokeWidth: 0,\n                    fill: 'black',\n                    width: 190,\n                    left: p.x,\n                    top: p.y - 7,\n                    originX: 'center',\n                    originY: 'bottom',\n                });\n                var tooltipBackground = new fabric_1.fabric.Rect({\n                    fill: chroma_js_1.default(event.target.fill).brighten(3).hex(),\n                    stroke: chroma_js_1.default(event.target.fill).hex(),\n                    strokeWidth: 1,\n                    width: tooltipText.width,\n                    height: tooltipText.height + 2,\n                    left: p.x,\n                    top: p.y - 5,\n                    originX: 'center',\n                    originY: 'bottom',\n                });\n                if (p.y < tooltipText.height + 10) {\n                    tooltipText.setOptions({\n                        originY: 'top',\n                        top: p.y + 15\n                    });\n                    tooltipBackground.setOptions({\n                        originY: 'top',\n                        top: p.y + 13\n                    });\n                }\n                var tooltip = new fabric_1.fabric.Group([tooltipBackground, tooltipText], { id: 'tooltip' });\n                that.add(tooltip);\n            }\n            that.requestRenderAll();\n        });\n        this.on('mouse:out', function () {\n            that.remove(that.getItem('tooltip'));\n            that.requestRenderAll();\n        });\n    };\n    InteractiveCanvas.prototype.addWikipediaLinks = function () {\n        this.on('mouse:down', function (event) {\n            if (event.target && event.target.url) {\n                window.open(event.target.url);\n            }\n        });\n    };\n    InteractiveCanvas.prototype.addKeyboardControl = function () {\n        var that = this;\n        document.onkeydown = function (e) {\n            switch (e.key) {\n                case 'ArrowLeft':\n                    that._pan(-30, 0);\n                    break;\n                case 'ArrowRight':\n                    that._pan(30, 0);\n                    break;\n                case 'ArrowUp':\n                    that._pan(0, -30);\n                    break;\n                case 'ArrowDown':\n                    that._pan(0, 30);\n                    break;\n                case '+':\n                    that._relativeZoom(0.25, new fabric_1.fabric.Point(0, 0));\n                    break;\n                case '-':\n                    that._relativeZoom(-0.25, new fabric_1.fabric.Point(0, 0));\n                    break;\n                case '0':\n                    that._absoluteZoom(1, new fabric_1.fabric.Point(0, 0));\n            }\n        };\n    };\n    InteractiveCanvas.clamp = function (min, value, max) {\n        return Math.max(min, Math.min(max, value));\n    };\n    return InteractiveCanvas;\n}(HistoryCanvas_1.HistoryCanvas));\nexports.InteractiveCanvas = InteractiveCanvas;\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 20;","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.FacetRenderer = void 0;\nvar Renderer_1 = require(\"./Renderer\");\nvar Person_1 = require(\"../models/Person\");\nvar Event_1 = require(\"../models/Event\");\nvar PersonRenderer_1 = require(\"./PersonRenderer\");\nvar EventRenderer_1 = require(\"./EventRenderer\");\nvar EraRenderer_1 = require(\"./EraRenderer\");\nvar Lanes_1 = require(\"./Lanes\");\nvar FacetRenderer = /** @class */ (function (_super) {\n    __extends(FacetRenderer, _super);\n    function FacetRenderer(canvas, facet) {\n        var _this = _super.call(this, canvas) || this;\n        _this.name = facet.name;\n        _this.eras = facet.eras;\n        _this.lanes = new Lanes_1.Lanes();\n        var objects = facet.people\n            .concat(facet.events)\n            .sort(function (one, two) { return one.orderByStart(two); });\n        _this.lanes.addObjects(objects);\n        _this.basecolor = facet.basecolor;\n        return _this;\n    }\n    FacetRenderer.prototype.render = function (offset) {\n        var _this = this;\n        this.eras.forEach(function (era) {\n            return new EraRenderer_1.EraRenderer(_this.canvas, era).render(offset, _this.lanes.size() * (_this.LANE_HEIGHT + _this.LANE_PADDING), _this.basecolor);\n        });\n        offset += this.LANE_PADDING / 2;\n        this.lanes.getLanes().forEach(function (lane) {\n            lane.forEach(function (object) {\n                switch (true) {\n                    case object instanceof Person_1.Person:\n                        new PersonRenderer_1.PersonRenderer(_this.canvas, object).render(offset, _this.basecolor);\n                        break;\n                    case object instanceof Event_1.Event:\n                        new EventRenderer_1.EventRenderer(_this.canvas, object).render(offset, _this.basecolor);\n                        break;\n                }\n            });\n            offset += _this.LANE_HEIGHT + _this.LANE_PADDING;\n        });\n        return offset - this.LANE_PADDING / 2;\n    };\n    return FacetRenderer;\n}(Renderer_1.Renderer));\nexports.FacetRenderer = FacetRenderer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PersonRenderer = void 0;\nvar Renderer_1 = require(\"./Renderer\");\nvar fabric_1 = require(\"fabric\");\nvar chroma_js_1 = __importDefault(require(\"chroma-js\"));\nvar HistoryCanvas_1 = require(\"../canvas/HistoryCanvas\");\nvar PersonRenderer = /** @class */ (function (_super) {\n    __extends(PersonRenderer, _super);\n    function PersonRenderer(canvas, person) {\n        var _this = _super.call(this, canvas) || this;\n        _this.name = person.name;\n        _this.birth = person.birth;\n        _this.death = person.death;\n        _this.events = person.events.sort(function (one, two) { return one.orderByStart(two); });\n        _this.shortName = person.shortName;\n        _this.url = person.url;\n        _this.left = HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(person.birth);\n        _this.width = HistoryCanvas_1.HistoryCanvas.calculateRelativeX(person.birth, person.death);\n        return _this;\n    }\n    PersonRenderer.prototype.render = function (offset, color) {\n        var _this = this;\n        var rect = new fabric_1.fabric.Rect({\n            fill: color.hex(),\n            left: this.left,\n            width: this.width,\n            top: offset,\n            height: this.LANE_HEIGHT,\n        });\n        var renderedEvents = this.events.map(function (it) { return _this.renderNestedEvent(it, offset, color); });\n        var textColor = color.luminance() > 0.4 ? chroma_js_1.default('black').hex() : chroma_js_1.default('white').hex();\n        var label = new fabric_1.fabric.Textbox(this.shortName, {\n            left: this.left + this.width / 2,\n            width: this.width,\n            top: offset + this.LANE_HEIGHT / 2,\n            originX: 'center',\n            originY: 'center',\n            fontSize: this.LANE_HEIGHT - 6,\n            textAlign: 'center',\n            strokeWidth: 0,\n            fill: textColor\n        });\n        var personGlyph = new fabric_1.fabric.Group(__spreadArrays([rect], renderedEvents, [label]), {\n            tooltipText: this.buildPersonTooltip(),\n            fill: color.hex(),\n            url: this.url\n        });\n        this.canvas.add(personGlyph);\n    };\n    PersonRenderer.prototype.renderNestedEvent = function (event, offset, color) {\n        return new fabric_1.fabric.Circle({\n            fill: color.darken(0.3).hex(),\n            left: HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(event.date),\n            top: offset + this.LANE_HEIGHT / 2,\n            originY: 'center',\n            originX: 'center',\n            radius: this.LANE_HEIGHT * 3 / 8,\n            strokeWidth: 1,\n            stroke: color.darken(0.9).hex()\n        });\n    };\n    PersonRenderer.prototype.buildPersonTooltip = function () {\n        var events = this.events.length > 0 ? '\\n' + this.events.map(function (it) { return it.name + ' (' + it.date.format('YYYY') + ')'; }).join(', ') : '';\n        return this.name + \"\\n\" + this.birth.format('YYYY') + \" - \" + this.death.format('YYYY') + events;\n    };\n    return PersonRenderer;\n}(Renderer_1.Renderer));\nexports.PersonRenderer = PersonRenderer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventRenderer = void 0;\nvar Renderer_1 = require(\"./Renderer\");\nvar fabric_1 = require(\"fabric\");\nvar HistoryCanvas_1 = require(\"../canvas/HistoryCanvas\");\nvar EventRenderer = /** @class */ (function (_super) {\n    __extends(EventRenderer, _super);\n    function EventRenderer(canvas, event) {\n        var _this = _super.call(this, canvas) || this;\n        _this.name = event.name;\n        _this.date = event.date;\n        _this.url = event.url;\n        _this.left = HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(event.date);\n        return _this;\n    }\n    EventRenderer.prototype.render = function (offset, color) {\n        var circle = new fabric_1.fabric.Circle({\n            fill: color.hex(),\n            left: this.left,\n            top: offset,\n            originX: 'center',\n            radius: this.LANE_HEIGHT / 2,\n            tooltipText: this.name + \"\\n\" + this.date.format('YYYY'),\n            color: color.hex(),\n            url: this.url\n        });\n        this.canvas.add(circle);\n    };\n    return EventRenderer;\n}(Renderer_1.Renderer));\nexports.EventRenderer = EventRenderer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EraRenderer = void 0;\nvar Renderer_1 = require(\"./Renderer\");\nvar fabric_1 = require(\"fabric\");\nvar moment_1 = __importDefault(require(\"moment\"));\nvar chroma_js_1 = __importDefault(require(\"chroma-js\"));\nvar HistoryCanvas_1 = require(\"../canvas/HistoryCanvas\");\nvar EraRenderer = /** @class */ (function (_super) {\n    __extends(EraRenderer, _super);\n    function EraRenderer(canvas, era) {\n        var _this = _super.call(this, canvas) || this;\n        _this.min_era_width_for_horizontal = HistoryCanvas_1.HistoryCanvas.calculateRelativeX(moment_1.default('0001-01-01', 'Y_MM_DD'), moment_1.default('00031-01-01', 'Y-MM-DD'));\n        _this.name = era.name;\n        _this.start = era.start;\n        _this.end = era.end;\n        _this.left = HistoryCanvas_1.HistoryCanvas.calculateAbsoluteX(era.start);\n        _this.width = HistoryCanvas_1.HistoryCanvas.calculateRelativeX(era.start, era.end);\n        return _this;\n    }\n    EraRenderer.prototype.render = function (offset, height, color) {\n        var rect = new fabric_1.fabric.Rect({\n            fill: color.brighten(0.2).alpha(0.1).hex(),\n            stroke: color.brighten(0.1).alpha(0.3).hex(),\n            strokeWidth: 2,\n            left: this.left,\n            width: this.width,\n            top: offset,\n            height: height\n        });\n        var isWideEnough = this.width > this.min_era_width_for_horizontal;\n        var label = new fabric_1.fabric.Textbox(this.name, {\n            left: this.left + this.width / 2,\n            width: isWideEnough ? Math.min(rect.width, 300) : height,\n            top: offset + height / 2,\n            originX: 'center',\n            originY: 'center',\n            angle: isWideEnough ? 0 : 270,\n            fontSize: this.LANE_HEIGHT,\n            textAlign: 'center',\n            strokeWidth: 0,\n            fill: chroma_js_1.default('darkgray').hex()\n        });\n        var eraGlyph = new fabric_1.fabric.Group([rect, label], {\n            tooltipText: this.name + \"\\n\" + this.start.format('YYYY') + \" - \" + this.end.format('YYYY'),\n            fill: color.hex()\n        });\n        var canvas = this.canvas;\n        eraGlyph.on('mouseover', function () {\n            rect.setOptions({\n                stroke: chroma_js_1.default('grey').hex(),\n            });\n            canvas.requestRenderAll();\n        });\n        eraGlyph.on('mouseout', function () {\n            rect.setOptions({\n                stroke: color.brighten(0.1).alpha(0.3).hex(),\n            });\n            canvas.requestRenderAll();\n        });\n        this.canvas.add(eraGlyph);\n    };\n    return EraRenderer;\n}(Renderer_1.Renderer));\nexports.EraRenderer = EraRenderer;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Lanes = void 0;\nvar Lanes = /** @class */ (function () {\n    function Lanes() {\n        this.lanes = [];\n    }\n    Lanes.prototype.size = function () {\n        return Object.keys(this.lanes).length;\n    };\n    Lanes.prototype.addLane = function () {\n        this.lanes[this.size()] = [];\n        return this.size() - 1;\n    };\n    Lanes.prototype.laneEnd = function (index) {\n        return this.lanes[index][this.lanes[index].length - 1].right();\n    };\n    Lanes.prototype.findLaneEndingBefore = function (date) {\n        for (var lane in Object.keys(this.lanes)) {\n            if (this.laneEnd(lane).add(3, 'y').isBefore(date)) {\n                return lane;\n            }\n        }\n        return this.addLane();\n    };\n    Lanes.prototype.addObject = function (object) {\n        var laneIndex = this.findLaneEndingBefore(object.left());\n        this.lanes[laneIndex].push(object);\n    };\n    Lanes.prototype.addObjects = function (objects) {\n        var _this = this;\n        objects.forEach(function (it) { return _this.addObject(it); });\n    };\n    Lanes.prototype.getLanes = function () {\n        return this.lanes;\n    };\n    return Lanes;\n}());\nexports.Lanes = Lanes;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Parser = void 0;\nvar chroma_js_1 = __importDefault(require(\"chroma-js\"));\nvar moment_1 = __importDefault(require(\"moment\"));\nvar Person_1 = require(\"./models/Person\");\nvar Era_1 = require(\"./models/Era\");\nvar Event_1 = require(\"./models/Event\");\nvar Facet_1 = require(\"./models/Facet\");\nvar Parser = /** @class */ (function () {\n    function Parser() {\n        this.DATE_PARSER_FORMAT = 'Y-MM-DD';\n    }\n    Parser.prototype.parseData = function (data) {\n        var _this = this;\n        var facets = Object.keys(data).map(function (facetName) {\n            return new Facet_1.Facet(facetName, (data[facetName].eras || []).map(function (it) { return _this.parseEra(it); }), (data[facetName].people || []).map(function (it) { return _this.parsePerson(it); }), (data[facetName].events || []).map(function (it) { return _this.parseEvent(it); }));\n        });\n        this.setColors(facets);\n        return facets;\n    };\n    Parser.prototype.setColors = function (facets) {\n        var colorScale = chroma_js_1.default.scale('Viridis').domain([0, facets.length - 1]);\n        facets.forEach(function (it, index) {\n            it.basecolor = colorScale(index);\n        });\n    };\n    Parser.prototype.parseEra = function (_a) {\n        var name = _a.name, start = _a.start, end = _a.end, _b = _a.url, url = _b === void 0 ? '' : _b;\n        return new Era_1.Era(name, this.parseDate(start), this.parseDate(end), url);\n    };\n    Parser.prototype.parsePerson = function (_a) {\n        var _this = this;\n        var name = _a.name, birth = _a.birth, death = _a.death, url = _a.url, _b = _a.events, events = _b === void 0 ? [] : _b, _c = _a.short_name, short_name = _c === void 0 ? '' : _c;\n        return new Person_1.Person(name, this.parseDate(birth), this.parseDate(death), url, events.map(function (it) { return _this.parseEvent(it); }), short_name === '' ? name : short_name);\n    };\n    Parser.prototype.parseEvent = function (_a) {\n        var name = _a.name, date = _a.date, url = _a.url;\n        return new Event_1.Event(name, this.parseDate(date), url);\n    };\n    Parser.prototype.parseDate = function (string) {\n        if (string === null) {\n            return null;\n        }\n        else if (string === 'now') {\n            return moment_1.default();\n        }\n        return moment_1.default(string, this.DATE_PARSER_FORMAT);\n    };\n    return Parser;\n}());\nexports.Parser = Parser;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Era = void 0;\nvar Orderable_1 = require(\"./Orderable\");\nvar Era = /** @class */ (function (_super) {\n    __extends(Era, _super);\n    function Era(name, start, end, url) {\n        if (url === void 0) { url = ''; }\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.start = start;\n        _this.end = end;\n        _this.url = url;\n        return _this;\n    }\n    Era.prototype.left = function () {\n        return this.start.clone();\n    };\n    Era.prototype.right = function () {\n        return this.end.clone();\n    };\n    return Era;\n}(Orderable_1.Orderable));\nexports.Era = Era;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Facet = void 0;\nvar Orderable_1 = require(\"./Orderable\");\nvar Facet = /** @class */ (function (_super) {\n    __extends(Facet, _super);\n    function Facet(name, eras, people, events) {\n        var _this = _super.call(this) || this;\n        _this.name = name;\n        _this.eras = eras.sort(function (one, two) { return one.orderByStart(two); });\n        _this.people = people.sort(function (one, two) { return one.orderByStart(two); });\n        _this.events = events.sort(function (one, two) { return one.orderByStart(two); });\n        return _this;\n    }\n    Facet.prototype.left = function () {\n        return [this.eras[0], this.people[0], this.events[0]].sort(function (one, two) { return one.orderByStart(two); })[0].left();\n    };\n    Facet.prototype.right = function () {\n        return [this.eras, this.people, this.events].flat().sort(function (one, two) { return one.orderByEnd(two); })[0].right();\n    };\n    return Facet;\n}(Orderable_1.Orderable));\nexports.Facet = Facet;\n"],"sourceRoot":""}